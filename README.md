# SVN Server WebUI

ä¸€ä¸ªåŸºäº Docker çš„ SVN æœåŠ¡å™¨ï¼Œæä¾›ç°ä»£åŒ–çš„ Web ç®¡ç†ç•Œé¢ï¼Œæ”¯æŒä»“åº“ç®¡ç†ã€ç”¨æˆ·æƒé™æ§åˆ¶å’Œä»£ç æµè§ˆåŠŸèƒ½ã€‚

> âš ï¸ **å®‰å…¨æç¤º**ï¼šæœ¬é¡¹ç›®åŒ…å«çš„é»˜è®¤å¯†ç ï¼ˆadmin/admin123ï¼‰ä»…ç”¨äºå¼€å‘å’Œæ¼”ç¤ºã€‚**ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰å¿…é¡»ä¿®æ”¹é»˜è®¤å¯†ç ï¼**

## åŠŸèƒ½ç‰¹æ€§

- ğŸš€ **ç°ä»£åŒ– Web UI** - åŸºäº React + TypeScript + Ant Design çš„ç®¡ç†ç•Œé¢
- ğŸ“¦ **ä»“åº“ç®¡ç†** - åˆ›å»ºã€åˆ é™¤ã€æµè§ˆ SVN ä»“åº“
- ğŸ‘¥ **ç”¨æˆ·ç®¡ç†** - ç”¨æˆ·åˆ›å»ºã€æƒé™åˆ†é…ã€è§’è‰²ç®¡ç†
- ğŸ“ **ä»£ç æµè§ˆ** - åœ¨çº¿æµè§ˆä»“åº“æ–‡ä»¶å’Œæäº¤å†å²
- ğŸ” **æƒé™æ§åˆ¶** - åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼ˆRBACï¼‰
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²** - æ”¯æŒ Docker ä¸€é”®éƒ¨ç½²
- ğŸŒ **å¤šæ¶æ„æ”¯æŒ** - æ”¯æŒ amd64 å’Œ arm64 æ¶æ„

## å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

1. å…‹éš†ä»“åº“ï¼š

```bash
git clone https://github.com/yourusername/svn-server-webui.git
cd svn-server-webui
```

2. æ„å»ºé•œåƒï¼š

```bash
# å¿…é¡»å…ˆæ„å»ºé•œåƒ
./build-docker.sh
```

3. å¯åŠ¨æœåŠ¡ï¼š

```bash
docker-compose up -d
```

æˆ–è€…ï¼Œå¦‚æœä½ æƒ³è¦è‡ªåŠ¨æ„å»ºï¼ˆå¼€å‘æ¨¡å¼ï¼‰ï¼š

```bash
docker-compose -f docker-compose.build.yml up -d
```

4. è®¿é—®æœåŠ¡ï¼š

- Web UI: http://localhost:5000
- SVN Server: http://localhost/svn/

é»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼š

- ç”¨æˆ·åï¼šadmin
- å¯†ç ï¼šadmin123

### ä½¿ç”¨ Docker

```bash
docker run -d \
  --name svn-server-webui \
  -p 80:80 \
  -p 5000:5000 \
  -v $(pwd)/data:/data \
  svn-server-webui:latest
```

> æ³¨ï¼šæ•°æ®å°†ä¿å­˜åœ¨å½“å‰ç›®å½•çš„ `data` æ–‡ä»¶å¤¹ä¸­

## ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å           | æè¿°                               | é»˜è®¤å€¼     |
| ---------------- | ---------------------------------- | ---------- |
| `PORT`           | Web UI ç«¯å£                        | 5000       |
| `ADMIN_USERNAME` | é»˜è®¤ç®¡ç†å‘˜ç”¨æˆ·åï¼ˆä»…é¦–æ¬¡å¯åŠ¨æœ‰æ•ˆï¼‰ | admin      |
| `ADMIN_PASSWORD` | é»˜è®¤ç®¡ç†å‘˜å¯†ç ï¼ˆä»…é¦–æ¬¡å¯åŠ¨æœ‰æ•ˆï¼‰   | admin123   |
| `NODE_ENV`       | è¿è¡Œç¯å¢ƒ                           | production |

æ³¨ï¼šå…¶ä»–é…ç½®å¦‚ JWT_SECRET ä¼šåœ¨å®¹å™¨å¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆï¼ŒSVN è·¯å¾„ç­‰å·²å†…ç½®é…ç½®ã€‚

## æ•°æ®æŒä¹…åŒ–

é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ•°æ®ä¿å­˜åœ¨å½“å‰ç›®å½•çš„ `./data` æ–‡ä»¶å¤¹ä¸­ã€‚æ‚¨å¯ä»¥ä¿®æ”¹ `docker-compose.yml` æ¥æŒ‚è½½åˆ°å…¶ä»–ä½ç½®ï¼š

```yaml
volumes:
  - /your/custom/path:/data  # ä¿®æ”¹ä¸ºæ‚¨æƒ³è¦çš„è·¯å¾„
```

æˆ–ä½¿ç”¨ Docker å‘½ä»¤æ—¶æŒ‡å®šï¼š

```bash
docker run -v /your/data/path:/data ...
```

**æ•°æ®ç›®å½•ç»“æ„**ï¼š

```
data/
â”œâ”€â”€ repos/      # SVN ä»“åº“æ•°æ®ï¼ˆä»£ç å’Œå†å²è®°å½•ï¼‰
â”œâ”€â”€ conf/       # SVN ç”¨æˆ·è®¤è¯æ–‡ä»¶
â”‚   â”œâ”€â”€ svn-auth-file    # ç”¨æˆ·å¯†ç 
â”‚   â””â”€â”€ svn-access-file  # è®¿é—®æƒé™
â””â”€â”€ app/        # Web UI æ•°æ®åº“
    â””â”€â”€ svn-webui.db     # ç”¨æˆ·ä¿¡æ¯ã€ä»“åº“å…ƒæ•°æ®ã€æƒé™è®¾ç½®
```

**å¤‡ä»½**ï¼šç›´æ¥å¤åˆ¶æ‚¨æŒ‚è½½çš„æ•°æ®ç›®å½•å³å¯ã€‚

**æ•°æ®åº“è¯´æ˜**ï¼š

- æ•°æ®åº“ä»…ä¿å­˜ Web UI ç›¸å…³ä¿¡æ¯ï¼ˆç”¨æˆ·ã€ä»“åº“æè¿°ã€æƒé™ï¼‰
- åˆ é™¤æ•°æ®åº“ä¸ä¼šå½±å“ SVN ä»“åº“æ•°æ®
- åˆ é™¤æ•°æ®åº“åä¼šé‡å»ºé»˜è®¤ç®¡ç†å‘˜è´¦å·ï¼Œä½†éœ€è¦é‡æ–°åˆ›å»ºå…¶ä»–ç”¨æˆ·

**âš ï¸ é‡è¦è­¦å‘Š**ï¼š

- æ•°æ®åº“å’Œ SVN è®¤è¯æ˜¯åˆ†ç¦»çš„ä¸¤ä¸ªç³»ç»Ÿ
- å¦‚æœåªåˆ é™¤æ•°æ®åº“ï¼ŒSVN è®¤è¯æ–‡ä»¶ä¸­çš„ç”¨æˆ·ä»ç„¶å­˜åœ¨
- å»ºè®®ï¼šå¦‚éœ€é‡ç½®ï¼ŒåŒæ—¶åˆ é™¤ `data/app/svn-webui.db` å’Œ `data/conf/svn-auth-file`

**æ³¨æ„äº‹é¡¹**ï¼š

- ç¯å¢ƒå˜é‡ `ADMIN_USERNAME` å’Œ `ADMIN_PASSWORD` ä»…åœ¨é¦–æ¬¡å¯åŠ¨æ—¶ç”Ÿæ•ˆ
- å·²æœ‰æ•°æ®æ—¶ï¼Œæ‰€æœ‰å¯†ç ä¿®æ”¹éƒ½åº”é€šè¿‡ Web UI è¿›è¡Œï¼ˆä¼šè‡ªåŠ¨åŒæ­¥åˆ° SVNï¼‰

## ä½¿ç”¨æŒ‡å—

### åˆ›å»ºä»“åº“

1. ç™»å½• Web UI
2. è¿›å…¥ "Repositories" é¡µé¢
3. ç‚¹å‡» "Create Repository" æŒ‰é’®
4. è¾“å…¥ä»“åº“åç§°å’Œæè¿°
5. ç‚¹å‡» "Create" åˆ›å»ºä»“åº“

### ç®¡ç†ç”¨æˆ·

1. è¿›å…¥ "Users" é¡µé¢ï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰
2. ç‚¹å‡» "Create User" åˆ›å»ºæ–°ç”¨æˆ·
3. è®¾ç½®ç”¨æˆ·åã€å¯†ç å’Œè§’è‰²
4. åœ¨ç”¨æˆ·åˆ—è¡¨ä¸­å¯ä»¥ç¼–è¾‘æˆ–åˆ é™¤ç”¨æˆ·

### è®¿é—® SVN ä»“åº“

ä½¿ç”¨ SVN å®¢æˆ·ç«¯è®¿é—®ä»“åº“ï¼š

```bash
# æ£€å‡ºä»“åº“
svn checkout http://localhost/svn/your-repo-name

# æäº¤ä»£ç ï¼ˆéœ€è¦è®¤è¯ï¼‰
svn commit -m "Your commit message" --username your-username
```

**æ™ºèƒ½åœ°å€æ˜¾ç¤º**ï¼š
- Web UI ä¼šæ ¹æ®ä½ è®¿é—®çš„åœ°å€è‡ªåŠ¨æ˜¾ç¤ºæ­£ç¡®çš„ SVN URL
- æ”¯æŒä¸€é”®å¤åˆ¶ SVN åœ°å€å’Œæ£€å‡ºå‘½ä»¤
- è‡ªåŠ¨å¤„ç†ç«¯å£æ˜ å°„ï¼ˆå¦‚ Web UI 7001 ç«¯å£å¯¹åº” SVN 8090 ç«¯å£ï¼‰

### æƒé™ç®¡ç†

ç³»ç»Ÿæ”¯æŒä¸¤ç§è§’è‰²ï¼š

- **Admin**: å®Œå…¨æ§åˆ¶æƒé™ï¼Œå¯ä»¥ç®¡ç†ä»“åº“å’Œç”¨æˆ·
- **User**: æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥è®¿é—®æˆæƒçš„ä»“åº“

## å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

1. å®‰è£…ä¾èµ–ï¼š

```bash
npm install
```

2. å¯åŠ¨åç«¯æœåŠ¡ï¼š

```bash
npm run dev:server
```

3. å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼š

```bash
npm run dev:client
```

### æ„å»ºé¡¹ç›®

```bash
# æ„å»ºå‰åç«¯
npm run build

# æ„å»º Docker é•œåƒï¼ˆå¤šæ¶æ„ï¼‰
npm run docker:build
```

### æ„å»ºè„šæœ¬è¯´æ˜

é¡¹ç›®æä¾›äº†ä»¥ä¸‹æ„å»ºè„šæœ¬å’Œé…ç½®æ–‡ä»¶ï¼š

1. **build-docker.sh** - æœ¬åœ° Docker é•œåƒæ„å»º

   ```bash
   ./build-docker.sh
   # æ„å»ºæœ¬åœ°ä½¿ç”¨çš„ Docker é•œåƒ (svn-server-webui:latest)
   ```

2. **build.sh** - å‘å¸ƒåˆ° Docker Hub

   ```bash
   # æœ¬åœ°æ„å»ºï¼ˆé»˜è®¤ï¼‰
   ./build.sh v1.0.0

   # æ„å»ºå¹¶æ¨é€å¤šæ¶æ„é•œåƒ
   ./build.sh v1.0.0 multi

   # ä½¿ç”¨ buildx æ„å»ºï¼ŒåŒæ—¶æ›´æ–°ç‰ˆæœ¬ tag å’Œ latest tag
   ./build.sh v1.0.0 buildx
   ```

3. **scripts/test-docker.sh** - Docker æµ‹è¯•è„šæœ¬

   ```bash
   ./scripts/test-docker.sh
   # è‡ªåŠ¨æµ‹è¯• Docker å®¹å™¨çš„åŸºç¡€åŠŸèƒ½
   ```

4. **Docker Compose é…ç½®æ–‡ä»¶**
   - `docker-compose.yml` - é»˜è®¤é…ç½®ï¼Œä½¿ç”¨é¢„æ„å»ºé•œåƒï¼ˆéœ€è¦å…ˆè¿è¡Œ build-docker.shï¼‰
   - `docker-compose.build.yml` - è‡ªåŠ¨æ„å»ºé…ç½®ï¼Œä¼šåœ¨å¯åŠ¨æ—¶æ„å»ºé•œåƒ
   - `docker-compose.prod.example.yml` - ç”Ÿäº§ç¯å¢ƒç¤ºä¾‹é…ç½®

### é¡¹ç›®ç»“æ„

```
svn-server-webui/
â”œâ”€â”€ client/          # React å‰ç«¯åº”ç”¨
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ pages/
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ types/
â”œâ”€â”€ server/          # Node.js åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ services/
â”œâ”€â”€ docker/          # Docker ç›¸å…³é…ç½®
â”‚   â”œâ”€â”€ apache/
â”‚   â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ supervisor/
â””â”€â”€ docker-compose.yml
```

## æŠ€æœ¯æ ˆ

- **å‰ç«¯**: React 18 + TypeScript + Ant Design 5 + Vite
- **åç«¯**: Node.js + Express + TypeScript
- **æ•°æ®åº“**: SQLite (better-sqlite3)
- **çŠ¶æ€ç®¡ç†**: @tanstack/react-query v5
- **è·¯ç”±**: React Router v6
- **SVN æœåŠ¡å™¨**: Apache + mod_dav_svn
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **è¿›ç¨‹ç®¡ç†**: Supervisor

## ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

å‚è€ƒ `docker-compose.prod.example.yml` é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ³¨æ„äº‹é¡¹ï¼š

1. **å®‰å…¨é…ç½®**ï¼š

   - ä½¿ç”¨ç¯å¢ƒå˜é‡è®¾ç½®å¯†ç ï¼Œé¿å…ç¡¬ç¼–ç 
   - é…ç½® HTTPSï¼ˆé€šè¿‡åå‘ä»£ç†ï¼‰
   - ä¿®æ”¹é»˜è®¤ç«¯å£
   - è®¾ç½®èµ„æºé™åˆ¶

2. **æ¨èçš„åå‘ä»£ç†é…ç½®**ï¼ˆNginx ç¤ºä¾‹ï¼‰ï¼š

```nginx
server {
    listen 443 ssl http2;
    server_name svn.yourcompany.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /svn {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## å®‰å…¨å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å‰**ï¼š

   - ä¿®æ”¹é»˜è®¤çš„ç®¡ç†å‘˜å¯†ç 
   - ä½¿ç”¨å¼ºå¯†ç ç­–ç•¥
   - é…ç½® HTTPS è®¿é—®
   - é™åˆ¶è®¿é—® IPï¼ˆé˜²ç«å¢™è§„åˆ™ï¼‰

2. **å®šæœŸç»´æŠ¤**ï¼š
   - å¤‡ä»½æ•°æ®ç›®å½•
   - æ›´æ–° Docker é•œåƒ
   - ç›‘æ§ç³»ç»Ÿæ—¥å¿—
   - å®¡è®¡ç”¨æˆ·è®¿é—®è®°å½•

## æ•…éšœæ’é™¤

### Web UI æ— æ³•è®¿é—®

- æ£€æŸ¥å®¹å™¨æ˜¯å¦æ­£å¸¸è¿è¡Œï¼š`docker-compose ps`
- æŸ¥çœ‹å®¹å™¨æ—¥å¿—ï¼š`docker-compose logs`

### SVN è®¤è¯å¤±è´¥

- ç¡®è®¤ç”¨æˆ·åå’Œå¯†ç æ­£ç¡®
- æ£€æŸ¥ Apache é…ç½®æ–‡ä»¶æƒé™

### ä»“åº“åˆ›å»ºå¤±è´¥

- æ£€æŸ¥ç£ç›˜ç©ºé—´
- ç¡®è®¤å®¹å™¨æœ‰å†™å…¥æƒé™

### æƒé™é”™è¯¯ï¼ˆmacOS/Windowsï¼‰

åœ¨ macOS æˆ– Windows ä¸Šä½¿ç”¨ Docker æ—¶ï¼Œå¯èƒ½ä¼šçœ‹åˆ°æƒé™ç›¸å…³çš„è­¦å‘Šï¼š

```
Warning: Cannot change ownership of /data (running on non-Linux host?)
```

è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºï¼š

- Docker Desktop åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œï¼Œæ–‡ä»¶æƒé™ç”±ä¸»æœºç³»ç»Ÿç®¡ç†
- å®¹å™¨ä»ç„¶å¯ä»¥æ­£å¸¸è¯»å†™æ–‡ä»¶
- è¿™äº›è­¦å‘Šä¸ä¼šå½±å“åŠŸèƒ½

### ç”¨æˆ·è®¤è¯ä¸ä¸€è‡´

å¦‚æœ Web UI å’Œ SVN ç”¨æˆ·ä¸åŒæ­¥ï¼š

1. åœæ­¢å®¹å™¨ï¼š`docker-compose down`
2. åˆ é™¤è®¤è¯æ–‡ä»¶ï¼š`rm data/app/svn-webui.db data/conf/svn-auth-file`
3. é‡å¯å®¹å™¨ï¼š`docker-compose up -d`
4. é‡æ–°åˆ›å»ºæ‰€æœ‰ç”¨æˆ·

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## è®¸å¯è¯

MIT License

